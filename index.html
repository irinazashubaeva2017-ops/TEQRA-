<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TEQRA :: FRACTURE</title>

<style>
html,body{
  margin:0;
  padding:0;
  background:#000;
  color:#cfd8dc;
  font-family:monospace;
  overflow:hidden;
}

/* ===== CANVAS ===== */
canvas{
  position:fixed;
  inset:0;
  z-index:0;
}

/* ===== TEXT LAYER ===== */
#ui{
  position:fixed;
  inset:0;
  z-index:3;
  display:flex;
  flex-direction:column;
  justify-content:flex-end;
  align-items:center;
  padding-bottom:18%;
  pointer-events:none;
}

#text{
  white-space:pre-line;
  text-align:center;
  font-size:0.85rem;
  letter-spacing:0.28em;
  opacity:0;
  transition:opacity 1s;
}

/* ===== CHOICES ===== */
#choices{
  position:fixed;
  bottom:6%;
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:12px;
  z-index:4;
}

.choice{
  width:82%;
  max-width:420px;
  padding:14px;
  text-align:center;
  border:1px solid rgba(255,255,255,0.35);
  background:rgba(0,0,0,0.4);
  letter-spacing:0.3em;
  cursor:pointer;
  transition:all .25s;
}

.choice:hover{
  background:rgba(255,255,255,0.08);
}

.choice.selected{
  background:rgba(255,255,255,0.15);
  box-shadow:0 0 20px currentColor;
  transform:scale(0.97);
}

.foundation{ color:#ffd180 }
.architecture{ color:#8be9ff }
.resonance{ color:#d7b7ff }

/* ===== TELEPORT EFFECT ===== */
.teleport{
  animation:teleport 1.2s forwards;
}

@keyframes teleport{
  0%{filter:none; transform:scale(1)}
  40%{filter:blur(6px) contrast(2); transform:scale(1.2)}
  100%{filter:blur(0); transform:scale(1)}
}

/* ===== GLITCH ===== */
.glitch{
  animation:glitch .15s infinite;
}

@keyframes glitch{
  0%{transform:translate(0)}
  20%{transform:translate(-2px,2px)}
  40%{transform:translate(2px,-2px)}
  60%{transform:translate(-2px,-2px)}
  80%{transform:translate(2px,2px)}
  100%{transform:translate(0)}
}
</style>
</head>

<body>

<canvas id="bin"></canvas>

<div id="ui">
  <div id="text"></div>
</div>

<div id="choices"></div>

<script>
/* ===== BINARY BACKGROUND ===== */
const c = document.getElementById("bin");
const x = c.getContext("2d");
let w,h;
function resize(){w=c.width=innerWidth;h=c.height=innerHeight}
window.onresize=resize; resize();

const cols = Math.floor(w/14);
const drops = new Array(cols).fill(0);

function draw(){
  x.fillStyle="rgba(0,0,0,.25)";
  x.fillRect(0,0,w,h);
  x.fillStyle="#00ff88";
  x.font="14px monospace";
  for(let i=0;i<drops.length;i++){
    x.fillText(Math.random()>.5?"1":"0",i*14,drops[i]*14);
    if(drops[i]*14>h||Math.random()>.98)drops[i]=0;
    drops[i]++;
  }
}
let speed = 50;
let loop = setInterval(draw,speed);

/* ===== UI ===== */
const text = document.getElementById("text");
const choices = document.getElementById("choices");

function say(t,hold=false){
  text.style.opacity=0;
  setTimeout(()=>{
    text.innerText=t;
    text.style.opacity=1;
    if(!hold)setTimeout(()=>text.style.opacity=0,3000);
  },700);
}

function setChoices(arr){
  choices.innerHTML="";
  arr.forEach(o=>{
    const d=document.createElement("div");
    d.className="choice "+o.cls;
    d.innerText=o.label;
    d.onclick=()=>select(d,o);
    choices.appendChild(d);
  });
}

/* ===== PROLOG ===== */
setTimeout(()=>say("СИСТЕМА TEQRA АКТИВНА"),800);
setTimeout(()=>say("ВНУТРІШНІ ПРОЦЕСИ КОНФЛІКТУЮТЬ"),4200);
setTimeout(()=>{
  say("ОБЕРИ ПРИНЦИП",true);
  text.classList.add("glitch");
},7600);

setTimeout(()=>{
  setChoices([
    {label:"ФУНДАМЕНТ /// СТІЙКІСТЬ", cls:"foundation", role:"foundation"},
    {label:"АРХІТЕКТОР /// ЛОГІКА", cls:"architecture", role:"architecture"},
    {label:"РЕЗОНАНС /// ЗВʼЯЗКИ", cls:"resonance", role:"resonance"}
  ]);
},9000);

/* ===== SELECTION ===== */
function select(el,o){
  document.querySelectorAll(".choice").forEach(c=>c.classList.remove("selected"));
  el.classList.add("selected");
  choices.style.pointerEvents="none";
  text.classList.remove("glitch");

  say("РІШЕННЯ ЗАФІКСОВАНО",true);
  speed=15; clearInterval(loop); loop=setInterval(draw,speed);

  document.body.classList.add("teleport");

  setTimeout(()=>chapter(o.role),1400);
}

/* ===== CHAPTERS ===== */
function chapter(role){
  document.body.classList.remove("teleport");
  choices.innerHTML="";
  text.style.opacity=0;

  if(role==="foundation"){
    say(
`ГЛАВА I — ФУНДАМЕНТ

ТИ НЕ ВИПРАВЛЯЄШ СВІТ.
ТИ ЙОГО УТРИМУЄШ.

КОЖЕН ЗБІЙ ПРИДУШЕНО.
КОЖНА ПОМИЛКА СХОВАНА.

СТАБІЛЬНІСТЬ —
ЦЕ ФОРМА НАСИЛЬСТВА.`,
true);
  }

  if(role==="architecture"){
    say(
`ГЛАВА I — АРХІТЕКТОР

ТИ БАЧИШ СТРУКТУРУ
ТАМ, ДЕ ІНШІ БАЧАТЬ ХАОС.

СИСТЕМА НЕ ЗЛАМАНА.
ВОНА ПОГАНО СПРОЄКТОВАНА.

ТИ ПОЧИНАЄШ ПЕРЕПИС.`,
true);
  }

  if(role==="resonance"){
    say(
`ГЛАВА I — РЕЗОНАНС

СИСТЕМА ВІДЧУВАЄ.

ЗВʼЯЗКИ НЕ СХВАЛЕНІ.
ПАМʼЯТЬ ПРОТІКАЄ.

ТИ НЕ КОНТРОЛЮЄШ.
ТИ СЛУХАЄШ.`,
true);
  }
}
</script>

</body>
</html>

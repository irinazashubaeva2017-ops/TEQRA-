<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>TEQRA // FOUNDATION</title>

<style>
:root{
  --bg:#000;
  --green:#00ff9c;
  --amber:#ffb454;
  --danger:#ff5555;
  --white:rgba(255,255,255,0.9);
}

*{margin:0;padding:0;box-sizing:border-box}

body{
  background:var(--bg);
  color:var(--white);
  font-family:"Courier New", monospace;
  height:100vh;
  overflow:hidden;
}

/* ===== CHAOTIC MATRIX ===== */
#matrix{
  position:fixed;
  inset:0;
  z-index:0;
  opacity:0.35;
}

/* ===== UI ===== */
#ui{
  position:relative;
  z-index:2;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
}

.panel{
  max-width:520px;
  text-align:center;
}

p{
  margin:14px 0;
  line-height:1.6;
  letter-spacing:0.04em;
}

.system{color:var(--green)}
.alert{color:var(--danger)}
.command{
  margin-top:28px;
  letter-spacing:0.3em;
  color:var(--amber);
  font-weight:bold;
}

/* ===== HOLD ZONE ===== */
#holdZone{
  margin-top:40px;
  padding:24px;
  border:1px solid rgba(255,255,255,0.25);
  transition:0.2s;
}

#holdZone.active{
  background:rgba(255,255,255,0.05);
  border-color:var(--amber);
}

/* ===== SHAKE ===== */
.shake{
  animation:shake 0.15s infinite;
}
@keyframes shake{
  0%{transform:translate(0,0)}
  25%{transform:translate(-2px,1px)}
  50%{transform:translate(2px,-1px)}
  75%{transform:translate(-1px,-2px)}
  100%{transform:translate(0,0)}
}
</style>
</head>

<body>

<canvas id="matrix"></canvas>

<div id="ui">
  <div class="panel" id="panel">

    <p class="system">FOUNDATION — MISSION 1</p>
    <p>Система втрачає звʼязність.</p>
    <p>Процеси розходяться.</p>

    <p class="alert">РІВЕНЬ РОЗПАДУ: <span id="entropy">72%</span></p>

    <p>Твоя задача — не виправляти.</p>
    <p>Твоя задача — утримувати.</p>

    <div id="holdZone">
      <p class="command">НАТИСНИ І УТРИМУЙ</p>
    </div>

  </div>
</div>

<script>
/* ===== MATRIX CHAOS ===== */
const c=document.getElementById("matrix");
const ctx=c.getContext("2d");
let w,h;
function resize(){w=c.width=innerWidth;h=c.height=innerHeight}
addEventListener("resize",resize);resize();

const cols=Math.floor(w/12);
let drops=Array(cols).fill(0);

function drawMatrix(){
  ctx.fillStyle="rgba(0,0,0,0.2)";
  ctx.fillRect(0,0,w,h);
  ctx.font="14px monospace";

  for(let i=0;i<drops.length;i++){
    let glitch=Math.random();
    let char= glitch>0.97 ? "█" : Math.random()>0.5?"1":"0";
    ctx.fillStyle= glitch>0.95 ? "#ff5555" : "#00ff9c";
    ctx.fillText(char,i*12,drops[i]*14);
    if(drops[i]*14>h||Math.random()>0.98)drops[i]=0;
    drops[i]+=Math.random()*1.5;
  }
}
setInterval(drawMatrix,40);

/* ===== GAME LOGIC ===== */
let entropy=72;
let holding=false;
const entropyEl=document.getElementById("entropy");
const panel=document.getElementById("panel");
const hold=document.getElementById("holdZone");

function update(){
  if(holding){
    entropy-=0.35;
    panel.classList.add("shake");
  }else{
    entropy+=0.25;
    panel.classList.remove("shake");
  }

  entropy=Math.max(0,Math.min(100,entropy));
  entropyEl.textContent=Math.floor(entropy)+"%";

  if(entropy<=5){
    win();
  }
}
setInterval(update,50);

/* ===== INPUT ===== */
function startHold(e){
  e.preventDefault();
  holding=true;
  hold.classList.add("active");
}
function endHold(){
  holding=false;
  hold.classList.remove("active");
}

hold.addEventListener("mousedown",startHold);
hold.addEventListener("touchstart",startHold,{passive:false});
addEventListener("mouseup",endHold);
addEventListener("touchend",endHold);

/* ===== WIN ===== */
function win(){
  clearInterval(update);
  panel.classList.remove("shake");
  panel.innerHTML=`
    <p class="system">СТАБІЛІЗАЦІЯ ДОСЯГНУТА</p>
    <p>Ти втримав систему.</p>
    <p>Не силою.</p>
    <p>Присутністю.</p>
    <p class="command">ГЛАВА II БУДЕ ПРОДОВЖЕНА</p>
  `;
}
</script>

</body>
</html>

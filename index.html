<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TEQRA :: SYSTEM FRACTURE</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
    background:#050507;
    color:#d8d8dc;
    font-family: monospace;
    overflow:hidden;
}

/* ===== BACKGROUND BINARY ===== */
#binary{
    position:fixed;
    inset:0;
    pointer-events:none;
    font-size:14px;
    line-height:18px;
    opacity:.15;
    white-space:pre;
    animation:flicker 4s infinite;
}
@keyframes flicker{
    0%,100%{opacity:.12}
    50%{opacity:.2}
}

/* ===== MAIN PANEL ===== */
#panel{
    position:relative;
    max-width:900px;
    margin:8vh auto;
    padding:40px;
    background:rgba(10,10,15,.7);
    border:1px solid rgba(255,255,255,.1);
    backdrop-filter:blur(6px);
}

/* ===== TEXT ===== */
.system{
    font-size:13px;
    letter-spacing:.2em;
    opacity:.6;
    margin-bottom:20px;
}
.text{
    font-size:18px;
    line-height:1.6;
    margin-bottom:20px;
}

/* ===== BUTTONS ===== */
.choice{
    border:1px solid rgba(255,255,255,.3);
    padding:14px;
    margin-top:15px;
    cursor:pointer;
    transition:.3s;
}
.choice:hover{
    background:rgba(255,255,255,.08);
}
.choice.active{
    border-color:#fff;
    background:rgba(255,255,255,.15);
}

/* ===== PROGRESS ===== */
#stability{
    height:6px;
    background:rgba(255,255,255,.1);
    margin-top:30px;
}
#stabilityFill{
    height:100%;
    width:20%;
    background:#9affc9;
    transition:.2s;
}

/* ===== GLITCH ===== */
.glitch{
    animation:glitch .15s infinite;
}
@keyframes glitch{
    0%{transform:translate(0)}
    25%{transform:translate(-2px,2px)}
    50%{transform:translate(2px,-1px)}
    75%{transform:translate(-1px,1px)}
    100%{transform:translate(0)}
}
</style>
</head>

<body>

<div id="binary"></div>

<div id="panel">
    <div class="system" id="systemLine">SYSTEM BOOT SEQUENCE</div>
    <div class="text" id="content"></div>
    <div id="choices"></div>
    <div id="stability" style="display:none">
        <div id="stabilityFill"></div>
    </div>
</div>

<script>
/* ===== BINARY BACKGROUND ===== */
const binary=document.getElementById("binary");
setInterval(()=>{
    let out="";
    for(let i=0;i<800;i++){
        out+=Math.random()>0.5?"1":"0";
        if(i%60===0)out+="\n";
    }
    binary.textContent=out;
},300);

/* ===== SCENE SYSTEM ===== */
const content=document.getElementById("content");
const choices=document.getElementById("choices");
const systemLine=document.getElementById("systemLine");
const stability=document.getElementById("stability");
const stabilityFill=document.getElementById("stabilityFill");

let scene="prologue";
let hold=false;
let value=20;

/* ===== PROLOGUE ===== */
content.innerHTML=
"System integrity compromised.<br><br>" +
"Core logic fractured.<br>" +
"Temporal alignment: FAILED.<br><br>" +
"You are connected to the last stable layer.";

choices.innerHTML=
"<div class='choice' onclick='selectPath(\"foundation\")'>FOUNDATION — hold structure</div>"+
"<div class='choice' onclick='selectPath(\"architect\")'>ARCHITECT — rewrite logic</div>"+
"<div class='choice' onclick='selectPath(\"resonance\")'>RESONANCE — synchronize flow</div>";

/* ===== PATH SELECT ===== */
function selectPath(p){
    document.querySelectorAll('.choice').forEach(c=>c.classList.remove('active'));
    event.target.classList.add('active');

    setTimeout(()=>{
        teleport(p);
    },800);
}

/* ===== TELEPORT ===== */
function teleport(p){
    document.body.classList.add("glitch");
    setTimeout(()=>{
        document.body.classList.remove("glitch");
        if(p==="foundation")startFoundation();
        else{
            content.innerHTML="PATH LOCKED.<br>Not implemented yet.";
            choices.innerHTML="";
        }
    },1000);
}

/* ===== FOUNDATION ARC ===== */
function startFoundation(){
    scene="foundation";
    systemLine.textContent="FOUNDATION PROTOCOL";
    content.innerHTML=
    "Reality weight detected.<br><br>"+
    "Your task is not action.<br>"+
    "Your task is endurance.<br><br>"+
    "Hold the system together.";

    choices.innerHTML="<div class='choice'>PRESS AND HOLD TO STABILIZE</div>";
    stability.style.display="block";

    document.addEventListener("mousedown",()=>hold=true);
    document.addEventListener("mouseup",()=>hold=false);
    document.addEventListener("touchstart",()=>hold=true);
    document.addEventListener("touchend",()=>hold=false);

    loop();
}

/* ===== FOUNDATION LOOP ===== */
function loop(){
    if(scene!=="foundation")return;

    if(hold){
        value+=0.6;
        document.body.classList.remove("glitch");
    }else{
        value-=0.8;
        document.body.classList.add("glitch");
    }

    value=Math.max(0,Math.min(100,value));
    stabilityFill.style.width=value+"%";

    if(value<=0){
        content.innerHTML="SYSTEM COLLAPSE.<br>You released the weight.";
        return;
    }

    if(value>=100){
        content.innerHTML=
        "Stability achieved.<br><br>"+
        "You did not fight.<br>"+
        "You endured.";
        document.body.classList.remove("glitch");
        return;
    }

    requestAnimationFrame(loop);
}
</script>

</body>
</html>
